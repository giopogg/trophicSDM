<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Composite variables and biotic-abiotic interactions • webSDM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Composite variables and biotic-abiotic interactions">
<meta property="og:description" content="webSDM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">webSDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction.html">Introduction</a>
    </li>
    <li>
      <a href="../articles/Composite_variables.html">Composite variables and biotic-abiotic interactions</a>
    </li>
    <li>
      <a href="../articles/Differences_with_SDMs.html">Subtle and obvious differences between SDM and trophic SDM</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/giopogg/webSDM/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Composite variables and biotic-abiotic interactions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/giopogg/webSDM/blob/HEAD/vignettes/Composite_variables.Rmd" class="external-link"><code>vignettes/Composite_variables.Rmd</code></a></small>
      <div class="hidden name"><code>Composite_variables.Rmd</code></div>

    </div>

    
    
<p>In this vignette we explain how to use composite variables in trophic SDM. These variables are useful especially in species-rich network, where some predators might have so many preys that assuming that each of them has a differential effect on predator distribution is not only a problem, but might seem ecologically unjustified. Instead, we could expect the richness or diversity of prey, or whether at least a prey is available, to be important. Hence, we implemented the use of composite variables, i.e., variables that summarize the information of a large number of variables from the graph in a few summary variables. Examples of composite variables are prey richness or diversity, or a binary variable set to one if the number of preys is above a certain threshold. These variables assume that all species have the same impact on the predator. An alternative is to group species in the metaweb to represent trophic groups that clump together species that feed on, or are eaten by, the same type of species. We can then construct composite variables (e.g., their richness) for each of those trophic groups to better represent the variety of resources for species like generalist or top predators.<br>
In <code>webSDM</code> it is possible to define an extremely large set of composite variables using the arguments <code>sp.formula</code> and <code>sp.partition</code>. In general, <code>sp.formula</code> allows the definition of the composite variables, while <code>sp.partition</code> allow to define the groups of preys (or predator) for which each composite variable is calculate. Hereafter we don’t provide a complete analyses of a case-study using composite variables, but rather focus on the description of how to implement them in <code>webSDM</code>. Finally, we will see how to include an interaction between preys and the environment.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/giopogg/webSDM" class="external-link">webSDM</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'sna::degree' by 'igraph::degree' when</span></span>
<span><span class="co">#&gt; loading 'webSDM'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">X</span> ,<span class="va">Y</span>, <span class="va">G</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="composite-variables">Composite variables<a class="anchor" aria-label="anchor" href="#composite-variables"></a>
</h2>
<p><code>sp.formula</code> can be a right hand side formula including richness (i.e. the sum of its preys) and any transformations of richness. Notice that only “richness” is allowed for now. However, we will see how this already allow to build an extremely large set of composite variable. We start with a simple case where we model species as a function of the richness of their prey, with a polynomial of degree two.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/trophicSDM.html">trophicSDM</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">X</span>, <span class="va">G</span>,</span>
<span>               env.formula <span class="op">=</span> <span class="st">"~ X_1 + X_1^2"</span>, </span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, penal <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               sp.formula <span class="op">=</span> <span class="st">"richness + I(richness^2)"</span>,</span>
<span>               mode <span class="op">=</span> <span class="st">"prey"</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y1 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y2 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y3 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y5 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y4 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y6 ---"</span></span></code></pre></div>
<p>Notice that for predators that feed on a single prey (with presence-absence data), their richness and the square of their richness is exactly the same variable. In this case, <code><a href="../reference/trophicSDM.html">trophicSDM()</a></code> removes the redundant variable but prints a warning message. We can see the formulas created by the argument <code>$form.all</code> of the fitted model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">$</span><span class="va">form.all</span></span>
<span><span class="co">#&gt; $Y1</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y2</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y3</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y5</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I(Y1 + Y2 + Y3)+I(I(Y1 + Y2 + Y3)^2)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y4</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I(Y3)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y6</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I(Y3 + Y5)+I(I(Y3 + Y5)^2)"</span></span></code></pre></div>
<p>We now set as composite variable a dummy variable specifying whether there is at least one available prey or not. To do so we define <code>sp.formula = "I(richness&gt;0)"</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/trophicSDM.html">trophicSDM</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span>,<span class="va">G</span>,</span>
<span>               env.formula <span class="op">=</span> <span class="st">"~ X_1 + X_1^2"</span>, </span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, penal <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               sp.formula <span class="op">=</span> <span class="st">"I(richness&gt;0)"</span>,</span>
<span>               mode <span class="op">=</span> <span class="st">"prey"</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y1 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y2 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y3 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y5 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y4 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y6 ---"</span></span></code></pre></div>
<p>Which leads to the following formulas:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">$</span><span class="va">form.all</span></span>
<span><span class="co">#&gt; $Y1</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y2</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y3</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y5</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I(I(Y1 + Y2 + Y3) &gt; 0)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y4</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I(I(Y3) &gt; 0)"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y6</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I(I(Y3 + Y5) &gt; 0)"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="composite-variables-and-groups-of-preys">Composite variables and groups of preys<a class="anchor" aria-label="anchor" href="#composite-variables-and-groups-of-preys"></a>
</h2>
<p>A halfway between considering that each species has a differential effect on the predator (i.e., no composite variable), or that every prey has the same effect (i.e., modeling predator as a function of prey richness), is to create group of species that we assume to have the same effect on the predator. Then, we can model predator as a function of composite variables calculated on each of these groups. To do so, we rely on the argument <code>sp.partition</code>. This parameters has to be a list, where each element contain the species of the given group.<br>
For example, we can put species Y1 and Y2 in the same group, species Y3 and Y4 are alone in their group and Y5 and Y6 to form another group.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp.partition</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>,<span class="st">"Y2"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y3"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y4"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y5"</span>,<span class="st">"Y6"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then, we can specify whatever <code>sp.formula</code>, for example using richness (with a quadratic term).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/trophicSDM.html">trophicSDM</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span>,<span class="va">G</span>, <span class="st">"~ X_1 + X_1^2"</span>, </span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, penal <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               sp.partition <span class="op">=</span> <span class="va">sp.partition</span>,</span>
<span>               sp.formula <span class="op">=</span> <span class="st">"richness + I(richness^2)"</span>,</span>
<span>               mode <span class="op">=</span> <span class="st">"prey"</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y1 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y2 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y3 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y5 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y4 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y6 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span></code></pre></div>
<p>Which leads to the following formulas:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span><span class="op">$</span><span class="va">form.all</span></span>
<span><span class="co">#&gt; $Y1</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y2</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y3</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y5</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I((Y1 + Y2))+I(I((Y1 + Y2)^2))+I((Y3))"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y4</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I((Y3))"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y6</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I((Y3))+I((Y5))"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="custom-formula">Custom formula<a class="anchor" aria-label="anchor" href="#custom-formula"></a>
</h2>
<p>In case we want to specify a composite variable that cannot be created from a function of richness, the user can specify directly the list of the biotic formulas in the <code>sp.formula</code> argument. Importantly, notice that in this case <code><a href="../reference/trophicSDM.html">trophicSDM()</a></code> will not create a new formula from the argument <code>G</code> and will not check that the user-defined formula actually derives from <code>G</code> (i.e. that predator-prey interactions described in the formulas derive from G). For example, we might want to quantify the effect of the prey Y5 on the predator Y6 when the prey Y3 is not available. To do so, we define for species Y6 an interaction term between species Y5 and one minus Y3 (i.e. a dummy variable that takes the value of 1 when species Y5 is present and Y3 is absent). To do so, we define <code>sp.formula</code> as a list describing the biotic formula for each species.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp.formula</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Y1 <span class="op">=</span> <span class="st">""</span>,</span>
<span>                  Y2 <span class="op">=</span> <span class="st">""</span>,</span>
<span>                  Y3 <span class="op">=</span> <span class="st">""</span>,</span>
<span>                  Y4 <span class="op">=</span> <span class="st">"Y3"</span>,</span>
<span>                  Y5 <span class="op">=</span> <span class="st">"Y1"</span>,</span>
<span>                  Y6 <span class="op">=</span> <span class="st">"I(Y5*(1-Y3))"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/trophicSDM.html">trophicSDM</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span>,<span class="va">G</span>, <span class="st">"~ X_1 + X_1^2"</span>, </span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, penal <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               sp.formula <span class="op">=</span> <span class="va">sp.formula</span>,</span>
<span>               mode <span class="op">=</span> <span class="st">"prey"</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; We don't check that G and the graph induced by the sp.formula specified by the user match, nor that the latter is a graph. Please be careful about their consistency.</span></span>
<span><span class="co">#&gt; [1] "--- Species Y1 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y2 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y3 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y5 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y4 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y6 ---"</span></span>
<span></span>
<span><span class="va">m</span><span class="op">$</span><span class="va">form.all</span></span>
<span><span class="co">#&gt; $Y1</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y2</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y3</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1 + X_1^2"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y5</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+Y1"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y4</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+Y3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Y6</span></span>
<span><span class="co">#&gt; [1] "y ~ X_1+I(Y5 * (1 - Y3))"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="on-computevariableimportance-with-composite-variable">On computeVariableImportance with composite variable<a class="anchor" aria-label="anchor" href="#on-computevariableimportance-with-composite-variable"></a>
</h2>
<p>When computing the importance of variables using the function <code>computeVariableImportance</code>, you should be careful with the definition of groups. Indeed, the function computes the variable importance of each group as the sum of the standardised regression coefficients containing some variables from the groups. Therefore, if species from different groups of variable are merged in the same composite variable, <code>computeVariableImportance</code> will sum the regression coefficient of the composite variable in different groups, leading to wrong results. For example, if <code>sp.formula = "richness"</code> and <code>sp.partition = NULL</code>, you should put all species in the same group in the argument <code>groups</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/trophicSDM.html">trophicSDM</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span>,<span class="va">G</span>,</span>
<span>               env.formula <span class="op">=</span> <span class="st">"~ X_1 + X_1^2"</span>, </span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, penal <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               sp.formula <span class="op">=</span> <span class="st">"richness + I(richness^2)"</span>,</span>
<span>               mode <span class="op">=</span> <span class="st">"prey"</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y1 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y2 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y3 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y5 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y4 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y6 ---"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/computeVariableImportance.html">computeVariableImportance</a></span><span class="op">(</span><span class="va">m</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"abiotic"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X_1"</span>, <span class="st">"X_2"</span><span class="op">)</span>,</span>
<span>                                           <span class="st">"biotic"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span>, <span class="st">"Y3"</span>,</span>
<span>                                                        <span class="st">"Y4"</span>, <span class="st">"Y5"</span>, <span class="st">"Y6"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in computeVariableImportance(m, groups = list(abiotic = c("X_1", :</span></span>
<span><span class="co">#&gt; If you use composite variables, you should group together species that belong</span></span>
<span><span class="co">#&gt; to the same composite variable. For example, if sp.formula = 'richness' and</span></span>
<span><span class="co">#&gt; sp.partition = NULL, you should put all species in the same group in the</span></span>
<span><span class="co">#&gt; argument 'groups'. If you define a partition of species in sp.partition, then</span></span>
<span><span class="co">#&gt; species in the same group in sp.partition should put all species in the same</span></span>
<span><span class="co">#&gt; group in the argument 'groups'</span></span>
<span><span class="co">#&gt;         Y1 Y2 Y3         Y5         Y4         Y6</span></span>
<span><span class="co">#&gt; abiotic  0  0  0 0.05380788 0.17251449 0.04623329</span></span>
<span><span class="co">#&gt; biotic   0  0  0 0.08470730 0.07633953 0.38116851</span></span></code></pre></div>
<p>If you use composite variables, you should group together species that belong to the same composite variable.If you define a partition of species in sp.partition, then species in the same group in sp.partition should put all species in the same group in the argument ‘groups’.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp.partition</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>,<span class="st">"Y2"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y3"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y4"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y5"</span>,<span class="st">"Y6"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/trophicSDM.html">trophicSDM</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span>,<span class="va">G</span>, <span class="st">"~ X_1 + X_1^2"</span>, </span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, penal <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               sp.partition <span class="op">=</span> <span class="va">sp.partition</span>,</span>
<span>               sp.formula <span class="op">=</span> <span class="st">"richness + I(richness^2)"</span>,</span>
<span>               mode <span class="op">=</span> <span class="st">"prey"</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y1 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y2 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y3 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y5 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y4 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span>
<span><span class="co">#&gt; [1] "--- Species Y6 ---"</span></span>
<span><span class="co">#&gt; Formula was modified since it led to identical columns of the design matrix (e.g. Y_1 or Y_1^2 for binary data)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/computeVariableImportance.html">computeVariableImportance</a></span><span class="op">(</span><span class="va">m</span>, groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"abiotic"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"X_1"</span>, <span class="st">"X_2"</span><span class="op">)</span>,</span>
<span>                                           <span class="st">"Group1"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y1"</span>, <span class="st">"Y2"</span><span class="op">)</span>,</span>
<span>                                           <span class="st">"Group2"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y3"</span><span class="op">)</span>,</span>
<span>                                           <span class="st">"Group3"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y4"</span>, <span class="st">"Y5"</span>, <span class="st">"Y6"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in computeVariableImportance(m, groups = list(abiotic = c("X_1", :</span></span>
<span><span class="co">#&gt; If you use composite variables, you should group together species that belong</span></span>
<span><span class="co">#&gt; to the same composite variable. For example, if sp.formula = 'richness' and</span></span>
<span><span class="co">#&gt; sp.partition = NULL, you should put all species in the same group in the</span></span>
<span><span class="co">#&gt; argument 'groups'. If you define a partition of species in sp.partition, then</span></span>
<span><span class="co">#&gt; species in the same group in sp.partition should put all species in the same</span></span>
<span><span class="co">#&gt; group in the argument 'groups'</span></span>
<span><span class="co">#&gt;         Y1 Y2 Y3        Y5         Y4         Y6</span></span>
<span><span class="co">#&gt; abiotic  0  0  0 0.1016899 0.17251449 0.03603087</span></span>
<span><span class="co">#&gt; Group1   0  0  0 0.8621983 0.00000000 0.00000000</span></span>
<span><span class="co">#&gt; Group2   0  0  0 0.2581345 0.07633953 0.22671385</span></span>
<span><span class="co">#&gt; Group3   0  0  0 0.0000000 0.00000000 0.11579149</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="interaction-with-biotic-and-abiotic-terms">Interaction with biotic and abiotic terms<a class="anchor" aria-label="anchor" href="#interaction-with-biotic-and-abiotic-terms"></a>
</h2>
<p>Assuming that the effect of prey on predators does not vary with environmental conditions might be a too strong assumption. In order to integrate species plasticity, it is possible to define a <code>sp.formula</code> that includes both biotic and abiotic terms. For example, we hereafter define an interaction between the prey and the environmental variable X_2.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sp.formula</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Y1 <span class="op">=</span> <span class="st">""</span>,</span>
<span>                  Y2 <span class="op">=</span> <span class="st">""</span>,</span>
<span>                  Y3 <span class="op">=</span> <span class="st">""</span>,</span>
<span>                  Y4 <span class="op">=</span> <span class="st">"I(X_2*Y3)"</span>,</span>
<span>                  Y5 <span class="op">=</span> <span class="st">"I(X_2*Y1)"</span>,</span>
<span>                  Y6 <span class="op">=</span> <span class="st">"I(X_2*Y3) + I(X_2*Y5)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="../reference/trophicSDM.html">trophicSDM</a></span><span class="op">(</span><span class="va">Y</span>,<span class="va">X</span>,<span class="va">G</span>,</span>
<span>               env.formula <span class="op">=</span> <span class="st">"~ X_1 + X_1^2"</span>, </span>
<span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, penal <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>               sp.formula <span class="op">=</span> <span class="va">sp.formula</span>,</span>
<span>               mode <span class="op">=</span> <span class="st">"prey"</span>, method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; We don't check that G and the graph induced by the sp.formula specified by the user match, nor that the latter is a graph. Please be careful about their consistency.</span></span>
<span><span class="co">#&gt; [1] "--- Species Y1 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y2 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y3 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y5 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y4 ---"</span></span>
<span><span class="co">#&gt; [1] "--- Species Y6 ---"</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Giovanni Poggiato, Jérémy Andréoletti.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
